{% extends "kontakti/base.html" %}

{% block title %}Kontakti sa pacijentima{% endblock %}

{% block content %}

<br>
<h3>Pacijenti...</h3>
<form action="{% url 'search' %} " class="col-md-3 pb-2 d-flex" role="search" method="post">
  {% csrf_token %}
  <input class="form-control me-6" type="text" name="search_term" placeholder="deo ili celo prezime">
  <button class="btn btn-secondary" type="submit">Traži</button>
</form>

<table class="table table-striped table-bordered table-responsive-sm">
  <tr class="table-success">
    <th>Pacijent</th>
    <th>Datum rođenja (starost)</th>
    <th>doktor</th>
    <th>dijagnoza</th>
    <th>anestezija</th>
    <th>poslednji kontakt</th>
    <th>&NonBreakingSpace;</th>
  </tr>

  {% for patient in patients %}

  <tr>
    <td><a href="{% url 'patient' patient.id %}">
        {{ patient.first_name}} {{ patient.last_name}}
      </a></td>
    <td>{{ patient.date_of_birth|date:"d.m.Y" }} (<strong>{{ patient.age|floatformat:"1" }}</strong>)</td>
    <td>{{ patient.doctor }}</td>
    <td>{{ patient.diagnose }}</td>
    <td>{% if patient.anestezija == True %}
      opšta
      {% else %}
      lokalna
      {% endif %}
    </td>
    <td>{{ patient.last_contact_date_time|date:"d.m.Y" }} {{ patient.last_contact_date_time|time:"H:i" }}</td>
    <td>
      <a class="btn btn-secondary" href="{% url 'edit_patient' patient.id %}">Promeni</a>
      <a class="btn btn-danger" href="{% url 'delete_patient' patient.id %}" onclick="return confirm('Da li ste sigurni da želite da izbrišete pacijenta {{ patient }}?');">Izbriši</a>
    </td>
  </tr>

  {% endfor %}

</table>

<p><a class="btn btn-secondary" href="{% url 'add_patient'%}">Dodaj pacijenta</a></p>


<script>
  function confirmDelete() {
    return confirm("Are you sure you want to delete this item?");
  }
</script>

{% endblock%}
